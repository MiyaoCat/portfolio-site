<%- include('header.ejs') %>
<inner-column>
	<h1 class="screaming-voice">Athletes</h1>
	
	<div class="filter">
		<label for="filterType" class="normal-voice">Filter Athletes:</label>
		<select id="filterDropDown">
			<option value="">- - Select - -</option>
			<% 			
				const sports = athletes.map( function(athlete) {
					return athlete.sport;
				})
				const sportsFlat = sports.flat();
				const uniqueSport = sportsFlat.filter(function(item, i, sportsFlat) {
					return i == sportsFlat.indexOf(item);
				})
				const sortedSports = uniqueSport.sort();
				function capFirstLetter(string) {
			    return string.charAt(0).toUpperCase() + string.slice(1);
			}
				sortedSports.forEach( function(sport) {
			%>	
				<option value="<%=sport%>"><%=capFirstLetter(sport)%></option>
			<% });%>
		</select>
	</div>
	<ul class="card-grid">
		<% athletes.forEach( function(athlete) { %>

			<li data-sport=<%=athlete.sport%>>
				<%- include('athlete-card.ejs', {athlete}) %>

				<div class="card-details">
					<a href="athlete/<%=athlete.slug%>">Athlete Bio</a>
					<button id='flipper'>Flip Card</button>
				</div>
			</li>

		<%});%>
	</ul>
</inner-column>

<%- include('footer.ejs') %>

<script>

	const filter = document.getElementById('filterDropDown');

	console.log(filter);
	const $athleteCard = document.querySelectorAll('athlete-card');
	const $button = document.querySelectorAll('button');

	$button.forEach( function($button, index) {
		let isFlipped = false;	
		
		$button.addEventListener('click', function(event) {
			$athleteCard[index].classList.toggle('hovered');
			this.innerText = 'flip back';

			if (isFlipped) {
				this.innerText = 'Flip Card';
			} else {
				this.innerText = 'Flip Back';
			}

			isFlipped = !isFlipped;
		});
	});

</script>
